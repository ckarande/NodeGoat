{% extends "./tutorial/layout.html" %} {% block title %}A10-Unvalidated Redirects and Forwards{% endblock %} {% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="bs-example" style="margin-bottom: 40px;">
            <span class="label label-warning">Exploitability: AVERAGE</span>
            <span class="label label-warning">Prevalence: COMMON</span>
            <span class="label label-danger">Detectability: EASY</span>
            <span class="label label-warning">Technical Impact: MODERATE</span>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Description</h3>
            </div>
            <div class="panel-body">Web applications frequently redirect and forward users to other pages and websites, and use untrusted data to determine the destination pages. Without proper validation, attackers can redirect victims to phishing or malware sites, or use forwards
                to access unauthorized pages.</div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Real World Attack Incident Examples</h3>
            </div>
            <div class="panel-body">Screencast here ...</div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Attack Scenario in Demo Application</h3>
                </p>
            </div>
            <div class="panel-body">
                <p>The "Learning Resources" link in the application redirects to another website without validating the url at line 42 in routes/index.js.
                    <pre>
                        // Handle redirect for learning resources link
                        app.get("/learn", function (req, res, next) {
                            return res.redirect(req.query.url);
                        });
                    </pre>
                    The url should be validated before redirecting.
                </p>
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">How Do I Prevent It?</h3>
            </div>
            <div class="panel-body">
                <p>Safe use of redirects and forwards can be done in a number of ways:</p>
                <ol>
                    <li>Simply avoid using redirects and forwards.</li>
                    <li>If used, don’t involve user parameters in calculating the destination. This can usually be done.</li>
                    <li>If destination parameters can’t be avoided, ensure that the supplied value is valid, and authorized for the user.
                        <br>It is recommended that any such destination parameters be a mapping value, rather than the actual URL or portion of the URL, and that server side code translate this mapping to the target URL.</li>
                </ol>
            </div>
        </div>
    </div>
</div>{% endblock %}